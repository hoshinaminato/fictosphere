# Fictosphere (构想界)

**Fictosphere** 是一个高性能的关系网络与世界观构建系统。它专为小说家、游戏策划和世界观构建者设计，集成了人物关系管理、蓝图地图编辑、时间轴日程管理和百科知识库四大核心模块。

本项目基于 **Electron**, **React**, **TypeScript**, 和 **D3.js** 构建，支持本地文件读写、高性能渲染以及多视觉主题切换。

## ✨ 核心功能

### 1. 关系系统 (Genealogy)
*   **双重视图**：
    *   **树状图 (Tree)**：清晰展示家族代际传承，支持自动层级排布。
    *   **关系网 (Network)**：力导向图展示复杂的人际纠葛（恋人、宿敌、同僚等）。
*   **深度编辑**：支持多附件（图片、文档）、自定义属性（RPG数值）、生平简介编辑。
*   **AI 辅助**：(可选) 集成 AI 分析人物关系的潜在冲突与剧情点。

### 2. 蓝图与地图编辑器 (Blueprint)
*   **世界地图**：绘制城市、地形、势力范围。支持平移、缩放和自定义节点样式。
*   **多层级架构**：支持无限层级的嵌套（世界 -> 建筑 -> 楼层 -> 房间）。
*   **可视化编辑**：拖拽式房间布局，物品放置，支持多种视觉主题（赛博朋克、水墨、手绘等）。

### 3. 日程与时间轴 (Calendar)
*   **多视图日程**：支持月视图、日视图（泳道图）、横向时间轴视图。
*   **动态模拟**：结合地图模块，可根据日程表在地图上动态模拟人物的位置移动（"Where is everyone?" 模式）。

### 4. 百科与设定集 (Wiki)
*   **关键词管理**：管理物品、法术、组织等设定，支持分类与标签。
*   **智能关联**：自动检测人物简介、日程描述和地图信息中的关键词，建立双向引用链接。

## 🚀 快速上手

### 基础操作指南

#### 👥 关系管理
1.  **新建人物**：在“关系”模块左侧面板点击“新建人员”。
2.  **建立关系**：
    *   **拖拽连线**（暂未实装，请使用按钮）：点击“新建关系”，选择源人物和目标人物。
    *   **编辑关系**：点击连线中间的标签，可在侧边栏调整关系类型（如：好友 -> 宿敌）和强度。
3.  **上传头像**：点击人物详情中的头像占位符即可上传本地图片。

#### 🗺️ 地图编辑
1.  **移动画布**：按住鼠标 **左键** 拖拽空白处（或中键）。
2.  **缩放视图**：使用鼠标滚轮。
3.  **添加节点/区域**：按住 **`Shift`** 键 + **点击** 画布空白处。
4.  **进入下级区域**：**双击** 地图上的节点（如建筑）或房间，即可进入内部编辑器。
5.  **返回上级**：点击顶部导航栏的面包屑或“返回”按钮。

#### 📅 日程规划
1.  **创建事件**：在日历任意视图点击“新建”或直接点击日期格。
2.  **关联地点**：在创建事件时选择已在地图模块中创建的地点，系统将自动建立关联。

### 快捷键
*   `Shift + Click` (蓝图): 快速绘制/添加节点。
*   `Wheel` (全局): 缩放视图。

## 🛠️ 项目搭建与开发

本项目需要 [Node.js](https://nodejs.org/) 环境 (推荐 v18+)。

### 1. 安装依赖

下载项目代码后，在根目录运行：

```bash
npm install
```

### 2. 启动开发环境

此命令将同时启动 Vite 开发服务器（前端热更新）和 Electron 窗口。

```bash
npm run dev
```

### 3. 打包构建

构建用于生产环境的应用包（输出至 `release` 目录）。支持 Windows (.exe), macOS (.dmg), Linux。

```bash
npm run dist
```

## 📁 目录结构

*   `components/`: React UI 组件
    *   `GenealogyModule`: 关系相关逻辑
    *   `BlueprintModule`: 地图编辑器逻辑
    *   `WorldEditor`: D3.js 地图渲染核心
*   `electron/`: Electron 主进程代码 (文件读写、窗口管理)
*   `services/`: 数据模拟与存储逻辑 (IndexedDB)
*   `types.ts`: TypeScript 类型定义

## 📄 协议与作者

*   **License**: [MIT License](LICENSE)
*   **Author**: Gemini (AI Architect)
*   **Co-author**: User (Creative Lead)

---
*Built with ❤️ by AI & Human Collaboration.*
